<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KibDocumentEvents - Interactive Demo</title>
    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@4.4.0/dist/full.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      .event-item {
        animation: fadeIn 0.3s ease-in;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .pulse-dot {
        animation: pulse 2s infinite;
      }
    </style>
  </head>
  <body class="bg-base-100">
    <div class="min-h-screen">
      <!-- Header -->
      <div class="navbar bg-base-200 shadow-lg">
        <div class="flex-1">
          <h1 class="text-xl font-bold">
            <i class="fas fa-bolt text-primary mr-2"></i>
            KibDocumentEvents Demo
          </h1>
        </div>
        <div class="flex-none">
          <div class="dropdown dropdown-end">
            <div tabindex="0" role="button" class="btn btn-ghost">
              Theme <i class="fas fa-chevron-down ml-1"></i>
            </div>
            <ul
              tabindex="0"
              class="dropdown-content menu bg-base-100 rounded-box z-[1] w-52 p-2 shadow"
            >
              <li><a onclick="setTheme('light')">Light</a></li>
              <li><a onclick="setTheme('dark')">Dark</a></li>
              <li><a onclick="setTheme('cupcake')">Cupcake</a></li>
              <li><a onclick="setTheme('synthwave')">Synthwave</a></li>
            </ul>
          </div>
        </div>
      </div>

      <div class="container mx-auto px-4 py-8">
        <!-- Status Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
          <div class="stat bg-base-200 rounded-box">
            <div class="stat-figure text-primary">
              <i class="fas fa-eye text-2xl"></i>
            </div>
            <div class="stat-title">Page Visibility</div>
            <div class="stat-value text-primary" id="visibility-status">
              Visible
            </div>
          </div>

          <div class="stat bg-base-200 rounded-box">
            <div class="stat-figure text-secondary">
              <i class="fas fa-wifi text-2xl"></i>
            </div>
            <div class="stat-title">Connection</div>
            <div class="stat-value text-secondary" id="connection-status">
              Online
            </div>
          </div>

          <div class="stat bg-base-200 rounded-box">
            <div class="stat-figure text-accent">
              <i class="fas fa-expand text-2xl"></i>
            </div>
            <div class="stat-title">Viewport</div>
            <div class="stat-value text-sm text-accent" id="viewport-size">
              1920x1080
            </div>
          </div>

          <div class="stat bg-base-200 rounded-box">
            <div class="stat-figure text-info">
              <i class="fas fa-mouse text-2xl"></i>
            </div>
            <div class="stat-title">Scroll</div>
            <div class="stat-value text-sm text-info" id="scroll-position">
              0, 0
            </div>
          </div>
        </div>

        <!-- Interactive Demo Cards -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <!-- Event Log -->
          <div class="card bg-base-200 shadow-xl">
            <div class="card-body">
              <h2 class="card-title">
                <i class="fas fa-list text-primary"></i>
                Live Event Log
                <div
                  class="pulse-dot w-3 h-3 bg-success rounded-full ml-auto"
                ></div>
              </h2>
              <div class="divider"></div>
              <div id="event-log" class="overflow-y-auto max-h-96 space-y-2">
                <!-- Events will appear here -->
              </div>
              <div class="card-actions justify-end mt-4">
                <button class="btn btn-outline btn-sm" id="clear-log">
                  <i class="fas fa-trash mr-2"></i>Clear Log
                </button>
              </div>
            </div>
          </div>

          <!-- Interactive Controls -->
          <div class="space-y-6">
            <!-- Keyboard Shortcuts -->
            <div class="card bg-base-200 shadow-xl">
              <div class="card-body">
                <h2 class="card-title">
                  <i class="fas fa-keyboard text-secondary"></i>
                  Keyboard Shortcuts
                </h2>
                <div class="space-y-2">
                  <div class="flex items-center justify-between">
                    <span>Save (Ctrl+S)</span>
                    <kbd class="kbd kbd-sm">Ctrl</kbd> +
                    <kbd class="kbd kbd-sm">S</kbd>
                  </div>
                  <div class="flex items-center justify-between">
                    <span>Help (F1)</span>
                    <kbd class="kbd kbd-sm">F1</kbd>
                  </div>
                  <div class="flex items-center justify-between">
                    <span>Escape</span>
                    <kbd class="kbd kbd-sm">Esc</kbd>
                  </div>
                </div>
              </div>
            </div>

            <!-- Clipboard Demo -->
            <div class="card bg-base-200 shadow-xl">
              <div class="card-body">
                <h2 class="card-title">
                  <i class="fas fa-clipboard text-accent"></i>
                  Clipboard Test
                </h2>
                <textarea
                  class="textarea textarea-bordered w-full"
                  placeholder="Try copying/pasting text here..."
                ></textarea>
              </div>
            </div>

            <!-- Drag & Drop Demo -->
            <div class="card bg-base-200 shadow-xl">
              <div class="card-body">
                <h2 class="card-title">
                  <i class="fas fa-file-upload text-warning"></i>
                  Drag & Drop Zone
                </h2>
                <div
                  id="drop-zone"
                  class="border-2 border-dashed border-base-300 rounded-lg p-8 text-center hover:border-primary transition-colors"
                >
                  <i
                    class="fas fa-cloud-upload-alt text-4xl text-base-300 mb-4"
                  ></i>
                  <p class="text-base-content/60">
                    Drop files here or drag text
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Footer with scroll content -->
        <div class="mt-16 space-y-8">
          <div class="divider">Scroll down to test scroll events</div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div
              class="card bg-gradient-to-br from-primary to-secondary text-primary-content shadow-xl"
            >
              <div class="card-body">
                <h3 class="card-title">DOM Events</h3>
                <p>Ready, loaded, visibility changes</p>
              </div>
            </div>
            <div
              class="card bg-gradient-to-br from-secondary to-accent text-secondary-content shadow-xl"
            >
              <div class="card-body">
                <h3 class="card-title">User Interactions</h3>
                <p>Keyboard, mouse, touch events</p>
              </div>
            </div>
            <div
              class="card bg-gradient-to-br from-accent to-primary text-accent-content shadow-xl"
            >
              <div class="card-body">
                <h3 class="card-title">System Events</h3>
                <p>Network, errors, navigation</p>
              </div>
            </div>
          </div>
          <div style="height: 100vh" class="flex items-center justify-center">
            <div class="text-center">
              <h2 class="text-3xl font-bold mb-4">Keep Scrolling!</h2>
              <p class="text-lg opacity-70">
                Watch the scroll position update in real-time
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script type="module">
      import docEvents from "../index.js";

      let eventCounter = 0;

      // Helper functions
      function logEvent(type, message, icon = "fa-info") {
        const log = document.getElementById("event-log");
        const eventItem = document.createElement("div");
        eventItem.className = "event-item alert alert-info p-2 text-sm";
        eventItem.innerHTML = `
                <i class="fas ${icon}"></i>
                <div>
                    <strong>${type}:</strong> ${message}
                    <div class="text-xs opacity-60">${new Date().toLocaleTimeString()}</div>
                </div>
            `;
        log.appendChild(eventItem);
        log.scrollTop = log.scrollHeight;

        // Remove old events (keep last 50)
        if (log.children.length > 50) {
          log.removeChild(log.firstChild);
        }
      }

      function updateStatus() {
        const state = docEvents.getState();
        document.getElementById("visibility-status").textContent =
          state.isVisible ? "Visible" : "Hidden";
        document.getElementById("connection-status").textContent =
          state.isOnline ? "Online" : "Offline";
        document.getElementById(
          "viewport-size"
        ).textContent = `${state.viewport.width}x${state.viewport.height}`;
        document.getElementById("scroll-position").textContent = `${Math.round(
          state.scroll.x
        )}, ${Math.round(state.scroll.y)}`;
      }

      // Theme switcher
      window.setTheme = (theme) => {
        document.documentElement.setAttribute("data-theme", theme);
        logEvent("Theme", `Switched to ${theme}`, "fa-palette");
      };

      // Initialize events
      docEvents.ready(() => {
        logEvent("DOM", "Document ready", "fa-check-circle");
        updateStatus();
      });

      docEvents.loaded(() => {
        logEvent("DOM", "All resources loaded", "fa-check-double");
      });

      // Keyboard events
      docEvents.onKeyboard((combo) => {
        if (combo.ctrl && combo.key === "s") {
          combo.preventDefault();
          logEvent("Keyboard", "Save shortcut (Ctrl+S)", "fa-save");
        } else if (combo.key === "F1") {
          combo.preventDefault();
          logEvent("Keyboard", "Help key (F1)", "fa-question-circle");
        } else if (combo.key === "Escape") {
          logEvent("Keyboard", "Escape key pressed", "fa-times");
        }
      });

      // Viewport events
      docEvents.onResize(() => {
        updateStatus();
        logEvent("Viewport", "Window resized", "fa-expand-arrows-alt");
      });

      docEvents.onScroll((scroll) => {
        updateStatus();
      });

      docEvents.onFocusChange((hasFocus) => {
        logEvent(
          "Focus",
          hasFocus ? "Window focused" : "Window blurred",
          hasFocus ? "fa-eye" : "fa-eye-slash"
        );
      });

      // Visibility changes
      docEvents.onVisibilityChange((hidden, state) => {
        updateStatus();
        logEvent(
          "Visibility",
          `Page ${hidden ? "hidden" : "visible"} (${state})`,
          hidden ? "fa-eye-slash" : "fa-eye"
        );
      });

      // Network events
      docEvents.onConnectionChange((online) => {
        updateStatus();
        logEvent(
          "Network",
          online ? "Back online" : "Gone offline",
          online ? "fa-wifi" : "fa-wifi-slash"
        );
      });

      // Clipboard events
      docEvents.onClipboard((event) => {
        logEvent(
          "Clipboard",
          `${event.type} operation: "${event.data.slice(0, 30)}${
            event.data.length > 30 ? "..." : ""
          }"`,
          "fa-clipboard"
        );
      });

      // Drag & drop
      const dropZone = document.getElementById("drop-zone");
      docEvents.onDragDrop((data) => {
        if (data.files.length > 0) {
          logEvent(
            "Drag & Drop",
            `${data.files.length} file(s) dropped`,
            "fa-file-upload"
          );
        } else if (data.text) {
          logEvent(
            "Drag & Drop",
            `Text dropped: "${data.text.slice(0, 30)}..."`,
            "fa-font"
          );
        }
      });

      // Error handling
      docEvents.onError((error) => {
        logEvent(
          "Error",
          `${error.type}: ${error.message || error.reason}`,
          "fa-exclamation-triangle"
        );
      });

      // Navigation events
      docEvents.onNavigation((nav) => {
        logEvent(
          "Navigation",
          `Navigated to ${nav.pathname}${nav.hash}`,
          "fa-compass"
        );
      });

      docEvents.onHashChange((hash) => {
        logEvent("Hash", `Hash changed to ${hash.hash}`, "fa-link");
      });

      // Clear log button
      document.getElementById("clear-log").addEventListener("click", () => {
        document.getElementById("event-log").innerHTML = "";
        logEvent("System", "Event log cleared", "fa-broom");
      });

      // Add some demo navigation for testing
      setTimeout(() => {
        logEvent(
          "System",
          "Demo initialized - try interacting with the page!",
          "fa-rocket"
        );
      }, 1000);
    </script>
  </body>
</html>
